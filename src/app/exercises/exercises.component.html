<div class="exercises-container">
  <div class="header">
    <h1>Exercise Manager</h1>
    <p>Define exercises for each muscle group</p>
    <div class="ai-toggle">
      <button 
        (click)="toggleAIMode()" 
        [class.active]="showAIMode()"
        class="ai-mode-btn">
        ðŸ¤– AI Mode
      </button>
    </div>
  </div>

  <!-- AI Mode Section -->
  @if (showAIMode()) {
    <div class="ai-section">
      <div class="ai-header">
        <h3>ðŸ¤– AI Exercise Suggestions</h3>
        <p>Describe your fitness goals and let AI suggest exercise groups and exercises.</p>
      </div>
      
      <div class="ai-input-section">
        <textarea 
          [(ngModel)]="aiInput"
          placeholder="e.g., 'Remove the arms exercises', 'Add cardio exercises', 'Replace squats with lunges', 'Create a full body workout', 'Reorganize my exercises'"
          class="ai-textarea"
          rows="3">
        </textarea>
        
            <div class="ai-actions">
              <button
                (click)="generateAISuggestions()"
                [disabled]="isGeneratingAI() || !aiInput().trim()"
                class="generate-btn">
                @if (isGeneratingAI()) {
                  <span class="loading">ðŸ¤– Generating...</span>
                } @else {
                  <span>Generate Suggestions</span>
                }
              </button>
              <button (click)="toggleAIMode()" class="cancel-btn">Cancel</button>
            </div>
          </div>

        </div>
      }

      <!-- AI Summary (outside AI card) -->
      @if (aiSummary()) {
        <div class="ai-summary-external">
          <div class="summary-header">
            <div class="summary-title-section">
              <span class="summary-icon">ðŸ“‹</span>
              <span class="summary-title">AI Summary</span>
            </div>
            <button (click)="clearAISummary()" class="summary-close-btn">Ã—</button>
          </div>
          <div class="summary-content">{{ aiSummary() }}</div>
        </div>
      }

  <!-- Category Management -->
  <div class="category-management">
    <div class="category-header">
      <h3>Groups</h3>
      <div class="add-category">
        <button (click)="addNewCategoryCard()">Add Group</button>
      </div>
    </div>
    
    @if (getCategories().length > 0) {
      <div class="groups-list">
        @for (category of getCategories(); track trackByIndex($index)) {
          <div class="group-card">
            <div class="group-header">
              <input 
                type="text" 
                [ngModel]="category"
                (ngModelChange)="updateCategoryName(category, $event)"
                placeholder="Enter group name (e.g., Arms)"
                class="category-name-input">
              <div class="header-actions">
                <button (click)="addExerciseToCategory(category)">Add Exercise</button>
                <button class="delete-btn" (click)="deleteCategory(category)">Ã—</button>
              </div>
            </div>
            <div class="group-body">
              <div class="exercises-list">
                @for (exercise of getExercisesByCategory(category); track trackByIndex($index)) {
                  <div class="exercise-item">
                    <div class="exercise-content">
                      <input 
                        type="text" 
                        [ngModel]="exercise.exerciseName"
                        (ngModelChange)="updateExerciseNameByIndex(category, $index, $event)"
                        class="exercise-name-input"
                        placeholder="Exercise name">
                      @if (exercise.description) {
                        <div class="exercise-description">{{ exercise.description }}</div>
                      }
                    </div>
                    <button class="delete-btn" (click)="deleteExerciseFromCategoryByIndex(category, $index)">Ã—</button>
                  </div>
                } @empty {
                  <div class="empty-state">No exercises in this group</div>
                }
              </div>
            </div>
          </div>
        }
      </div>
    } @else {
      <div class="empty-state">No groups yet. Create one above.</div>
    }
  </div>

  <div class="save-actions">
    <button (click)="saveAll()" [disabled]="isSaving()">
      @if (isSaving()) {
        <span class="loading">ðŸ’¾ Saving...</span>
      } @else {
        <span>Save All</span>
      }
    </button>
  </div>
</div>

